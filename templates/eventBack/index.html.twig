{% extends 'baseBack.html.twig' %}

{% block title %}Event List{% endblock %}

{% block body %}
<style>
    body {
        font-family: 'Poppins', sans-serif;
        background: #f9f9f9;
        margin: 0;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .page-title {
        font-size: 2.7rem;
        color: #231a6f;
        margin-bottom: 30px;
        font-weight: 600;
        text-align: center;
        width: 100%;
    }

    table {
        width: 100%;
        max-width: 1300px;
        border-collapse: collapse;
        background-color: #fff;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
        overflow: hidden;
    }

    th, td {
        padding: 16px;
        text-align: center;
        border-bottom: 1px solid #ddd;
    }

    th {
        background-color: #231a6f;
        color: white;
        font-weight: 500;
    }

    tr:hover {
        background-color: #f1f1f1;
    }

    .btn {
        padding: 8px 12px;
        border-radius: 6px;
        color: white;
        text-decoration: none;
        font-size: 13px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin: 2px;
        transition: transform 0.2s ease;
    }

    .btn i {
        margin-right: 5px;
    }

    .show-btn {
        background: linear-gradient(45deg, #231a6f, #4b3c9e);
    }

    .edit-btn {
        background: linear-gradient(45deg, #aaa, #666);
    }

    .delete-btn {
        background: linear-gradient(45deg, #e74c3c, #c0392b);
    }

    .display-btn {
        background: linear-gradient(45deg, #26941e, #34b614);
    }

    .add-btn {
        background: linear-gradient(45deg, #1d1460, #4b3c9e);
    }

    .btn:hover {
        transform: scale(1.05);
    }

    .create-btn {
        background: linear-gradient(45deg, #000, #1a1a1a);
        color: #fff;
        padding: 12px 20px;
        border-radius: 8px;
        text-decoration: none;
        font-size: 16px;
        display: inline-block;
        margin: 30px 0;
        transition: background-color 0.3s, transform 0.3s;
    }

    .create-btn:hover {
        background-color: #000;
        transform: scale(1.05);
    }

    @media (max-width: 992px) {
        table, thead, tbody, th, td, tr {
            display: block;
        }

        th {
            display: none;
        }

        td {
            position: relative;
            padding-left: 50%;
            text-align: left;
        }

        td::before {
            position: absolute;
            left: 10px;
            width: 45%;
            white-space: nowrap;
            font-weight: bold;
            color: #231a6f;
        }

        td:nth-of-type(1)::before { content: "Name"; }
        td:nth-of-type(2)::before { content: "Date"; }
        td:nth-of-type(3)::before { content: "Location"; }
        td:nth-of-type(4)::before { content: "Organiser"; }
        td:nth-of-type(5)::before { content: "Type"; }
        td:nth-of-type(6)::before { content: "Participants"; }
        td:nth-of-type(7)::before { content: "Price"; }
        td:nth-of-type(8)::before { content: "Actions"; }
    }
</style>

<h1 class="page-title">Event List</h1>

{% if events|length > 0 %}
<table>
    <thead>
        <tr>
            <th>Name</th>
            <th>Date</th>
            <th>Location</th>
            <th>Organiser</th>
            <th>Type</th>
            <th>Participants</th>
            <th>Price (DT)</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for event in events %}
            <tr>
                <td>{{ event.name }}</td>
                <td>{{ event.date ? event.date|date('Y-m-d') : '' }}</td>
                <td>{{ event.location }}</td>
                <td>{{ event.organiser }}</td>
                <td>{{ event.eventType }}</td>
                <td>{{ event.nbParticipant }}</td>
                <td>{{ event.ticketPrice }}</td>
                <td>
                    <a href="{{ path('app_event_show_back', {'id': event.id}) }}" class="btn show-btn"><i class="fas fa-eye"></i>Show</a>
                    <a href="{{ path('app_event_edit_back', {'id': event.id}) }}" class="btn edit-btn"><i class="fas fa-edit"></i>Edit</a>
                    <form method="post" action="{{ path('app_event_delete_back', {'id': event.id}) }}" onsubmit="return confirm('Are you sure you want to delete this item?');" style="display:inline-block">
                        <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ event.id) }}">
                        <button class="btn delete-btn"><i class="fas fa-trash-alt"></i>Delete</button>
                    </form>
                    <a href="{% if event.hasFormation %}{{ path('app_formation_show_back', {'id': event.formationId}) }}{% else %}#{% endif %}" class="btn display-btn" {% if not event.hasFormation %}style="pointer-events: none; opacity: 0.5;"{% endif %}>
                        <i class="fas fa-chalkboard-teacher"></i>Display
                    </a>
                    <a href="{{ path('app_formation_new_back', {'eventId': event.id}) }}" 
   class="btn add-btn" 
   {% if event.hasFormation %}
       style="pointer-events: none; opacity: 0.5;" 
       title="This event already has a formation"
   {% endif %}>
    <i class="fas fa-plus-circle"></i> Add
</a>
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
    <p>No events found.</p>
{% endif %}

<a href="{{ path('app_event_new_back') }}" class="create-btn"><i class="fas fa-plus-circle"></i> Create New Event</a>
{% endblock %}